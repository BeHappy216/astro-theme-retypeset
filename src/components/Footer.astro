---
import { themeConfig } from '@/config'
import { getLangFromPath } from '@/i18n/lang'
import { getLocalizedPath } from '@/i18n/path'

const { url: siteUrl, author } = themeConfig.site
const { links: socialLinks, startYear } = themeConfig.footer

const currentYear = new Date().getFullYear()
const year = Number(startYear) === currentYear ? startYear : `${startYear}-${currentYear}`

// i18n RSS Feed Path
const currentLang = getLangFromPath(Astro.url.pathname)
const links = socialLinks.map(({ name, url, ...rest }) => {
  if (name === 'RSS') {
    return { name, url: getLocalizedPath(url, currentLang), ...rest }
  }

  if (name === 'Email') {
    return { name, url: url.startsWith('mailto:') ? url : `mailto:${url}`, ...rest }
  }

  return { name, url, ...rest }
})

const footerLinkClass = 'highlight-hover py-0.8 transition-colors after:bottom-0.35em hover:c-primary'
---

<footer class="mt-auto flex items-center justify-between pt-8 text-sm">
  <div>
    {links.map((link, index) => (
      <>
        <a class={footerLinkClass} href={link.url} target="_blank" rel="noopener noreferrer">{link.name}</a>{index < links.length - 1 && <span class="mx-2">/</span>}
      </>
    ))}
  </div>

  <div>
    Â© {year} <a href={siteUrl}>{author}</a>
  </div>
</footer>
